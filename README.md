![Liferay Mobile SDK logo](https://github.com/liferay/liferay-mobile-sdk/raw/master/logo.png)

# Liferay Android OAuth Library

* [Setup](#setup)
* [Use](#use)

## Setup

The [OAuth Provider](https://www.liferay.com/marketplace/-/mp/application/45261909) portlet must be installed on your Liferay Portal in order to enable authentication with OAuth. This portlet is currently available for EE customers only.

Read its [documentation](https://dev.liferay.com/discover/portal/-/knowledge_base/6-2/oauth) to generate the consumer key and secret for your app, they will be used by the Mobile SDK to sign your requests and we will refer to them in this document.

In your Android project, you need to add the library as a dependency, in the build.gradle file:

```groovy
repositories {
	jcenter()
	mavenCentral()
}

dependencies {
	compile group: 'com.liferay.mobile', name: 'liferay-android-oauth', version: '1.+'
}
```

## Use

Create a `Session` instance passing a `OAuth` instance:

```java
import com.liferay.mobile.android.auth.Authentication;
import com.liferay.mobile.android.oauth.OAuth;

Authentication auth = new OAuth(consumerKey, consumerSecret, token, tokenSecret);
Session session = new SessionImpl("http://localhost:8080", auth);

GroupService service = new GroupService(session);
JSONArray sites = service.getUserSites();
```

As you can see, you need to pass `consumerKey` and `consumerSecret` in the `OAuth` constructor. These parameters are tied to your app and, as mentioned earlier, must be generated by the [OAuth Provider](https://dev.liferay.com/discover/portal/-/knowledge_base/6-2/oauth) portlet.

`token` and `tokenSecret` are the tokens required by the OAuth 1.0a protocol. They are used to identify the user once he has granted permission to your app. In order to obtain them, the user needs to authenticate through the OAuth flow, that is, your app must open a web browser showing the portal's login page and user needs to login and grant permission to your app.

You can implement that part yourself, using any available Android OAuth 1.0a library. Alternatively, we also provide helper classes to obtain `token` and `tokenSecret`. See the sections bellow.

### External Browser

### Internal WebView

Create a `OAuthWebView` instance within your app layout XML file:

```xml
<com.liferay.mobile.android.oauth.view.OAuthWebView
	android:id="@+id/webView"
	android:layout_width="match_parent"
	android:layout_height="wrap_content" />
```

